<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> KalPro| COSTAATT Bursar Department</title>
  <style>
    :root {
      --primary-color: #6a0dad;
      --secondary-color: #ff7043;
      --accent-color: #ff9800;
      --light-bg: #f9f9f9;
      --dark-bg: #1a1a2e;
      --dark-card: #16213e;
      --dark-text: #e6e6e6;
      --light-text: #333;
      --shadow: 0 5px 15px rgba(0,0,0,0.1);
      --transition: all 0.3s ease;
    }

    .dark-mode {
      --light-bg: var(--dark-bg);
      --light-text: var(--dark-text);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      transition: var(--transition);
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--light-bg);
      color: var(--light-text);
      line-height: 1.6;
      padding: 20px;
      transition: var(--transition);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      border-radius: 15px;
      background: linear-gradient(135deg, var(--primary-color), #8a2be2);
      color: white;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
      z-index: 0;
    }

    header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      position: relative;
      z-index: 1;
    }

    header p {
      font-size: 1.2rem;
      opacity: 0.9;
      position: relative;
      z-index: 1;
    }

    .theme-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255,255,255,0.2);
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: white;
      z-index: 1;
      transition: var(--transition);
    }

    .theme-toggle:hover {
      transform: rotate(30deg);
      background: rgba(255,255,255,0.3);
    }

    .calculator-card {
      background-color: white;
      border-radius: 15px;
      box-shadow: var(--shadow);
      padding: 25px;
      margin-bottom: 25px;
      transition: var(--transition);
    }

    .dark-mode .calculator-card {
      background-color: var(--dark-card);
    }

    h2, h3 {
      color: var(--primary-color);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
    }

    .dark-mode h2, .dark-mode h3 {
      color: var(--secondary-color);
    }

    h2::before, h3::before {
      margin-right: 10px;
      font-size: 1.5em;
    }

    h2::before {
      content: "📊";
    }

    h3::before {
      content: "💰";
    }

    .controls {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    button {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }

    .btn-primary:hover {
      background-color: #5a0b9d;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    .btn-secondary {
      background-color: var(--secondary-color);
      color: white;
    }

    .btn-secondary:hover {
      background-color: #e65c3e;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    .btn-accent {
      background-color: var(--accent-color);
      color: white;
    }

    .btn-accent:hover {
      background-color: #e68900;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background-color: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 20px;
    }

    .dark-mode table {
      background-color: var(--dark-card);
    }

    th, td {
      padding: 15px;
      text-align: center;
      border-bottom: 1px solid #e0e0e0;
    }

    .dark-mode th, .dark-mode td {
      border-bottom: 1px solid #2d3746;
    }

    th {
      background-color: var(--primary-color);
      color: white;
      font-weight: 600;
      text-transform: uppercase;
      font-size: 14px;
    }

    tr:nth-child(even) {
      background-color: #f8f4ff;
    }

    .dark-mode tr:nth-child(even) {
      background-color: #1f2a40;
    }

    tr:hover {
      background-color: #f0e5ff;
    }

    .dark-mode tr:hover {
      background-color: #2a3650;
    }

    input, select {
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ddd;
      transition: var(--transition);
      width: 100%;
    }

    .dark-mode input, .dark-mode select {
      background-color: #2d3746;
      border-color: #3a4558;
      color: var(--dark-text);
    }

    input:focus, select:focus {
      border-color: var(--primary-color);
      outline: none;
      box-shadow: 0 0 5px rgba(106,13,173,0.3);
    }

    .total-display {
      font-weight: bold;
      color: var(--primary-color);
      font-size: 18px;
    }

    .dark-mode .total-display {
      color: var(--secondary-color);
    }

    .fee-calculator {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .fee-item {
      display: flex;
      flex-direction: column;
    }

    .fee-item label {
      font-weight: bold;
      margin-bottom: 8px;
      color: var(--primary-color);
    }

    .dark-mode .fee-item label {
      color: var(--secondary-color);
    }

    .fee-input {
      position: relative;
    }

    .fee-input::before {
      content: "$";
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: #666;
    }

    .fee-input input {
      padding-left: 25px;
    }

    .totals-section {
      background-color: #f3e5f5;
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .dark-mode .totals-section {
      background-color: #2a1b3d;
    }

    .totals-section div {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .grand-total {
      font-size: 24px;
      font-weight: bold;
      border-top: 2px solid var(--primary-color);
      padding-top: 15px;
      margin-top: 15px;
    }

    .dark-mode .grand-total {
      border-top-color: var(--secondary-color);
    }

    .disclaimer {
      background-color: #fff8e6;
      border-left: 5px solid #ffa726;
      padding: 20px;
      margin-top: 30px;
      border-radius: 0 10px 10px 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    .dark-mode .disclaimer {
      background-color: #332b1a;
      border-left-color: #e68900;
    }

    .disclaimer h3 {
      margin-top: 0;
      color: #e65100;
      border-bottom: 1px solid #e0c800;
      padding-bottom: 10px;
    }

    .dark-mode .disclaimer h3 {
      color: #ffa726;
    }

    .disclaimer p {
      margin-bottom: 15px;
    }

    .disclaimer ol {
      margin: 15px 0;
      padding-left: 20px;
    }

    .disclaimer li {
      margin-bottom: 10px;
    }

    .course-type-tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 2px solid #e0e0e0;
    }

    .dark-mode .course-type-tabs {
      border-bottom-color: #3a4558;
    }

    .course-type-tab {
      padding: 12px 24px;
      cursor: pointer;
      background-color: #f1f1f1;
      border: 1px solid #ddd;
      border-bottom: none;
      margin-right: 5px;
      border-radius: 8px 8px 0 0;
      transition: var(--transition);
    }

    .dark-mode .course-type-tab {
      background-color: #2d3746;
      border-color: #3a4558;
      color: var(--dark-text);
    }

    .course-type-tab.active {
      background-color: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }

    .dark-mode .course-type-tab.active {
      background-color: var(--secondary-color);
      border-color: var(--secondary-color);
    }

    .short-courses-section {
      display: none;
    }

    .instructions {
      background-color: #ede7f6;
      border-left: 5px solid var(--primary-color);
      padding: 20px;
      margin-bottom: 30px;
      border-radius: 0 10px 10px 0;
      display: none;
    }

    .dark-mode .instructions {
      background-color: #2a1b3d;
      border-left-color: var(--secondary-color);
    }

    .instructions.show {
      display: block;
    }

    @media (max-width: 768px) {
      .fee-calculator {
        grid-template-columns: 1fr;
      }
      
      .course-type-tabs {
        flex-direction: column;
      }
      
      .course-type-tab {
        border-radius: 8px;
        margin-bottom: 5px;
      }
      
      header h1 {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <button class="theme-toggle" id="themeToggle">🌙</button>
      <h1>KalPro</h1>
      <p>Student Calculator by COSTAATT Bursar Department</p>
    </header>

    <button class="btn-accent" onclick="toggleInstructions()" style="margin-bottom: 20px;">
      <span>📝</span> Show Instructions
    </button>

    <div class="instructions" id="instructions">
<strong style="font-size: 16px;">📝 Instructions:</strong><br><br>
1. <span style="background-color: #ede7f6; font-weight: bold; padding: 2px 5px;">Use the Tuition Calculator section</span> to calculate your course fees by adding rows for each course.<br>

2. <span style="background-color: #ede7f6; font-weight: bold; padding: 2px 5px;">If you are a GATE-funded student doing a repeated course</span>, you will need to self-fund that course.<br>

3. <span style="background-color: #ede7f6; font-weight: bold; padding: 2px 5px;">Core Courses</span> refers to all courses within the undergraduate program.<br>

4. <span style="background-color: #ede7f6; font-weight: bold; padding: 2px 5px;">Compass Courses</span> are not funded by GATE if you are enrolled in an undergraduate program. Only students enrolled in the Compass program are eligible for GATE coverage for these courses.<br>

5. <span style="background-color: #ede7f6; font-weight: bold; padding: 2px 5px;">Postgraduate Students</span>, Please select the <strong>postgraduate tab</strong> for course details and registration.<br>

6. <span style="background-color: #ede7f6; font-weight: bold; padding: 2px 5px;">The College Fees Calculator section</span> lets you calculate other college expenses separately from tuition.<br>

7. <span style="background-color: #ede7f6; font-weight: bold; padding: 2px 5px;"><strong>GATE Funding</strong> is only available to <strong>Local Nationals</strong> for <strong>Undergraduate Courses</strong></span>.<br>

8. Click <strong>"Add Row"</strong> to include more courses (maximum of 8 rows).<br>

9. Use <strong>"Reset Table"</strong> to clear the tuition calculator.<br>

    </div>

    <div class="course-type-tabs">
      <div class="course-type-tab active" id="undergradTab" onclick="switchCourseType('undergrad')">Undergraduate Courses</div>
      <div class="course-type-tab" id="gradTab" onclick="switchCourseType('grad')">Postgraduate Courses</div>
    </div>

    <div class="calculator-card">
      <h3>Tuition Calculator (Late Fee Applies from 1st October, 2025)</h3>
      
      <div class="controls">
        <button class="btn-primary" id="addRowBtn">
          <span>➕</span> Add Row
        </button>
        <button class="btn-secondary" id="resetTableBtn">
          <span>🔄</span> Reset Table
        </button>
      </div>

      <table id="tuitionTable">
        <thead>
          <tr>
            <th>Student Type</th>
            <th>Credits</th>
            <th>Course Description</th>
            <th>Course Type</th>
            <th>Tuition Fee</th>
            <th>GATE</th>
            <th>Total</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="tableBody"></tbody>
        <tfoot>
          <tr>
            <td colspan="6"><strong>Tuition Grand Total</strong></td>
            <td><span id="tuitionGrandTotal" class="total-display">$0.00</span></td>
            <td></td>
          </tr>
        </tfoot>
      </table>
    </div>

    <div class="calculator-card">
      <h3>College Fees Calculator</h3>
      
      <div class="fee-calculator">
        <div class="fee-item">
          <label for="registrationFee">Registration Fee:</label>
          <select id="registrationFee">
            <option value="0">$0</option>
            <option value="280">$280</option>
            <option value="410">$410</option>
          </select>
        </div>
        
        <div class="fee-item">
          <label for="lateFee">Late Fee:</label>
          <select id="lateFee">
            <option value="0">$0</option>
            <option value="50">$50</option>
          </select>
        </div>
      </div>
      
      <div class="controls">
        <button class="btn-accent" onclick="resetCollegeFees()">
          <span>🔄</span> Reset College Fees
        </button>
      </div>
    </div>

    <div class="calculator-card">
      <h3>Other Fees</h3>
      
      <div class="fee-calculator">
        <div class="fee-item">
          <label for="otherFees">Other Fees:</label>
          <div class="fee-input">
            <input type="number" id="otherFees" min="0" value="0">
          </div>
        </div>
      </div>
      
      <div class="controls">
        <button class="btn-accent" onclick="resetOtherFees()">
          <span>🔄</span> Reset Other Fees
        </button>
      </div>
    </div>

    <div class="calculator-card">
      <div class="totals-section">
        <div>
          <span>Tuition Fees Total:</span>
          <span id="displayTuitionTotal" class="total-display">$0.00</span>
        </div>
        <div>
          <span>College Fees Total:</span>
          <span id="displayCollegeFeesTotal" class="total-display">$0.00</span>
        </div>
        <div>
          <span>Other Fees Total:</span>
          <span id="displayOtherFeesTotal" class="total-display">$0.00</span>
        </div>
        <div class="grand-total">
          <span>Grand Total:</span>
          <span id="grandTotal" class="total-display">$0.00</span>
        </div>
      </div>
    </div>

    <div class="disclaimer">
      <h3>Legal Disclaimer</h3>
      <p>The calculations provided by this calculator are <strong>estimates only</strong> and are based on the fees inputted by you, the student, from your invoice.</p>
      <p>This tool serves as a <strong>guidance tool</strong> and does not represent official fees approved by the college.</p>
      <p>The <strong>Bursar's Office</strong> must review and verify all calculations to confirm the accuracy of your payment plan and total amount due.</p>
      
      <p>Additional important information:</p>
      <ol>
        <li>A late fee will be applied if payment is submitted after the college fee deadline (refer to the Academic Calendar)</li>
        <li>All figures are denominated in Trinidad and Tobago Dollars (TTD) unless otherwise specified</li>
        <li>GATE funding calculations are based on current government policies which may be amended</li>
        <li>Final tuition obligations must be verified with the institution's Bursar Department</li>
        <li>Course availability and credit requirements may affect actual fees</li>
      </ol>
      
      <p style="font-weight:bold; border-top:1px solid #ccc; padding-top:10px;">
      This tool does not constitute professional financial advice under the Financial Institutions Act, Chap. 79:09 of Trinidad and Tobago.
      </p>
    </div>
  </div>

  <script>
     
    const studentTypes = ['Local National', 'Caricom National', 'International National'];
    const courseOptions = ['Compass Course', 'Undergraduate Course', 'Repeated Course'];
    const gradCourseOptions = ['Compass Course', 'Graduate Course', 'Repeated Course'];
      const gateOptions = ['0%', '25%', '50%', '75%', '100%'];
    const creditOptions = [1, 2, 3, 4, 5];
    
    // Tuition fees for undergraduate, graduate and short courses
    let tuitionFees = {
      'undergrad': {
        'Local National': 300,
        'Caricom National': 450,
        'International National': 750
      },
      'grad': {
        'Local National': 500,
        'Caricom National': 600,
        'International National': 750
      }
    };
    
    const maxRows = 8;
    let currentRowCount = 0;
    let lastSelectedType = 'Local National';
    let lastSelectedGate = '0%';
    let currentCourseType = 'undergrad'; // 'undergrad', 'grad', or 'short'

    function switchCourseType(type) {
      currentCourseType = type;
      document.getElementById('undergradTab').classList.remove('active');
      document.getElementById('gradTab').classList.remove('active');
          document.getElementById(type + 'Tab').classList.add('active');
      
      // Update all rows with new tuition fees
      for (let i = 0; i < currentRowCount; i++) {
        updateRow(i);
      }
      
      // Update totals
      updateTotalsSection();
    }

    function createRow(index) {
      if (currentRowCount >= maxRows) return;

      const row = document.createElement('tr');
      row.dataset.index = index;

      // Student Type
      const studentCell = document.createElement('td');
      const studentSelect = document.createElement('select');
      studentTypes.forEach(type => {
        const option = document.createElement('option');
        option.value = type;
        option.text = type;
        if (type === lastSelectedType) option.selected = true;
        studentSelect.appendChild(option);
      });
      studentSelect.addEventListener('change', () => {
        lastSelectedType = studentSelect.value;
        updateRow(index);
      });
      studentCell.appendChild(studentSelect);
      row.appendChild(studentCell);

      // Credits Selector
      const creditCell = document.createElement('td');
      const creditSelect = document.createElement('select');
      creditOptions.forEach(credit => {
        const option = document.createElement('option');
        option.value = credit;
        option.text = credit;
        creditSelect.appendChild(option);
      });
      creditSelect.addEventListener('change', () => {
        updateRow(index);
      });
      creditCell.appendChild(creditSelect);
      row.appendChild(creditCell);

      // Course Description (based on credits)
      const courseDescCell = document.createElement('td');
      const courseDescSpan = document.createElement('span');
      courseDescSpan.id = `courseDesc-${index}`;
      courseDescSpan.textContent = 'Select credits';
      courseDescCell.appendChild(courseDescSpan);
      row.appendChild(courseDescCell);

      // Course Type
      const courseCell = document.createElement('td');
      const courseSelect = document.createElement('select');
      const allowedCourseTypes = currentCourseType === 'undergrad' ? 
        ['Compass Course', 'Undergraduate Course', 'Repeated Course'] : 
        ['Compass Course', 'Graduate Course', 'Repeated Course'];
      
      allowedCourseTypes.forEach(course => {
        const option = document.createElement('option');
        option.value = course;
        option.text = course;
        courseSelect.appendChild(option);
      });
      courseSelect.addEventListener('change', () => {
        updateRow(index);
      });
      courseCell.appendChild(courseSelect);
      row.appendChild(courseCell);

      // Tuition Fee
      const feeCell = document.createElement('td');
      const feeInput = document.createElement('input');
      feeInput.type = 'number';
      feeInput.readOnly = true;
      feeInput.style.backgroundColor = '#f5f5f5';
      feeInput.style.border = '1px solid #ddd';
      feeCell.appendChild(feeInput);
      row.appendChild(feeCell);

      // GATE
      const gateCell = document.createElement('td');
      const gateSelect = document.createElement('select');
      gateOptions.forEach(optionVal => {
        const option = document.createElement('option');
        option.value = optionVal;
        option.text = optionVal;
        if (optionVal === lastSelectedGate) option.selected = true;
        gateSelect.appendChild(option);
      });
      gateSelect.addEventListener('change', () => {
        lastSelectedGate = gateSelect.value;
        updateRow(index);
      });
      gateCell.appendChild(gateSelect);
      row.appendChild(gateCell);

      // Total
      const totalCell = document.createElement('td');
      const totalSpan = document.createElement('span');
      totalSpan.id = `total-${index}`;
      totalSpan.textContent = '$0.00';
      totalSpan.style.fontWeight = 'bold';
      totalCell.appendChild(totalSpan);
      row.appendChild(totalCell);

      // Clear Button
      const actionCell = document.createElement('td');
      const clearBtn = document.createElement('button');
      clearBtn.textContent = '❌';
      clearBtn.style.background = 'none';
      clearBtn.style.border = 'none';
      clearBtn.style.cursor = 'pointer';
      clearBtn.style.fontSize = '18px';
      clearBtn.addEventListener('click', () => clearRow(index));
      actionCell.appendChild(clearBtn);
      row.appendChild(actionCell);

      document.getElementById('tableBody').appendChild(row);
      currentRowCount++;
      updateRow(index);

      if (currentRowCount >= maxRows) {
        document.getElementById('addRowBtn').disabled = true;
      }
    }

    function updateRow(index) {
      const row = document.getElementById('tableBody').rows[index];
      if (!row) return;

      const studentType = row.cells[0].querySelector('select').value;
      const credits = parseInt(row.cells[1].querySelector('select').value) || 0;
      const courseType = row.cells[3].querySelector('select').value;
      const feeInput = row.cells[4].querySelector('input');
      const gateSelect = row.cells[5].querySelector('select');

      // Update course description based on credits
      const courseDescSpan = document.getElementById(`courseDesc-${index}`);
      if (credits === 1) {
        courseDescSpan.textContent = 'One Credit Course';
      } else if (credits === 2) {
        courseDescSpan.textContent = 'Two Credit Course';
      } else if (credits === 3) {
        courseDescSpan.textContent = 'Three Credit Course';
      } else if (credits === 4) {
        courseDescSpan.textContent = 'Four Credit Course';
      } else if (credits === 5) {
        courseDescSpan.textContent = 'Five Credit Course';
      } else {
        courseDescSpan.textContent = 'Select credits';
      }

      // Get tuition fee based on course type (undergrad/grad) and student type
      const tuitionFee = tuitionFees[currentCourseType][studentType];
      feeInput.value = tuitionFee;

      // Disable GATE if not Local National OR if not Undergraduate Course
      const isCompassOrRepeated = courseType === 'Compass Course' || courseType === 'Repeated Course';
      const isUndergradCourse = courseType === 'Undergraduate Course';
      const isLocalNational = studentType === 'Local National';
      
      gateSelect.disabled = !isLocalNational || !isUndergradCourse || isCompassOrRepeated;
      
      // If not eligible for GATE, force to 0%
      if (!isLocalNational || !isUndergradCourse || isCompassOrRepeated) {
        gateSelect.value = '0%';
      }

      const gateVal = gateSelect.value;
      const gateMap = {
        '0%': 1,
        '25%': 0.75,
        '50%': 0.5,
        '75%': 0.25,
        '100%': 0
      };
      const gateMultiplier = (isLocalNational && isUndergradCourse && !isCompassOrRepeated) ? gateMap[gateVal] : 1;

      const total = credits * tuitionFee * gateMultiplier;
      document.getElementById(`total-${index}`).textContent = `$${total.toFixed(2)}`;

      computeTuitionGrandTotal();
      updateTotalsSection();
    }

    function computeTuitionGrandTotal() {
      let total = 0;
      for (let i = 0; i < currentRowCount; i++) {
        const totalText = document.getElementById(`total-${i}`)?.textContent || '$0';
        total += parseFloat(totalText.replace('$', '')) || 0;
      }
      document.getElementById('tuitionGrandTotal').textContent = `$${total.toFixed(2)}`;
      document.getElementById('displayTuitionTotal').textContent = `$${total.toFixed(2)}`;
      updateGrandTotal();
    }

    function updateCollegeFeesCalculator() {
      const registrationFee = parseFloat(document.getElementById('registrationFee').value) || 0;
      const lateFee = parseFloat(document.getElementById('lateFee').value) || 0;
      
      const totalCollegeFees = registrationFee + lateFee;
      
      document.getElementById('displayCollegeFeesTotal').textContent = `$${totalCollegeFees.toFixed(2)}`;
      updateGrandTotal();
    }

    function updateOtherFeesCalculator() {
      const otherFees = parseFloat(document.getElementById('otherFees').value) || 0;
      document.getElementById('displayOtherFeesTotal').textContent = `$${otherFees.toFixed(2)}`;
      updateGrandTotal();
    }

    function updateTotalsSection() {
      updateCollegeFeesCalculator();
      updateOtherFeesCalculator();
      updateGrandTotal();
    }

    function updateGrandTotal() {
      const tuitionTotal = parseFloat(document.getElementById('displayTuitionTotal').textContent.replace('$', '')) || 0;
      const collegeFeesTotal = parseFloat(document.getElementById('displayCollegeFeesTotal').textContent.replace('$', '')) || 0;
      const otherFeesTotal = parseFloat(document.getElementById('displayOtherFeesTotal').textContent.replace('$', '')) || 0;
      const grandTotal = tuitionTotal + collegeFeesTotal + otherFeesTotal;
      document.getElementById('grandTotal').textContent = `$${grandTotal.toFixed(2)}`;
    }

    function resetCollegeFees() {
      document.getElementById('registrationFee').value = '0';
      document.getElementById('lateFee').value = '0';
      updateCollegeFeesCalculator();
    }

    function resetOtherFees() {
      document.getElementById('otherFees').value = '0';
      updateOtherFeesCalculator();
    }

    function clearRow(index) {
      const row = document.getElementById('tableBody').rows[index];
      if (!row) return;

      row.cells[1].querySelector('select').value = '1';
      document.getElementById(`courseDesc-${index}`).textContent = 'One Credit Course';
      row.cells[3].querySelector('select').value = courseOptions[0];
      row.cells[4].querySelector('input').value = tuitionFees[currentCourseType][lastSelectedType];
      row.cells[5].querySelector('select').value = lastSelectedGate;
      document.getElementById(`total-${index}`).textContent = '$0.00';

      updateRow(index);
    }

    function resetTable() {
      document.getElementById('tableBody').innerHTML = '';
      document.getElementById('tuitionGrandTotal').textContent = '$0.00';
      document.getElementById('displayTuitionTotal').textContent = '$0.00';
      currentRowCount = 0;
      document.getElementById('addRowBtn').disabled = false;
      createRow(0);
      updateTotalsSection();
    }

    function toggleInstructions() {
      const instructions = document.getElementById('instructions');
      const button = event.target.closest('button');
      const isVisible = instructions.classList.contains('show');

      if (isVisible) {
        instructions.classList.remove('show');
        button.innerHTML = '<span>📝</span> Show Instructions';
      } else {
        instructions.classList.add('show');
        button.innerHTML = '<span>📝</span> Hide Instructions';
      }
    }

    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      const themeToggle = document.getElementById('themeToggle');
      if (document.body.classList.contains('dark-mode')) {
        themeToggle.textContent = '☀️';
        themeToggle.title = 'Switch to Light Mode';
      } else {
        themeToggle.textContent = '🌙';
        themeToggle.title = 'Switch to Dark Mode';
      }
    }

    // Initial setup
    document.getElementById('addRowBtn').addEventListener('click', () => {
      if (currentRowCount < maxRows) {
        createRow(currentRowCount);
      }
    });

    document.getElementById('resetTableBtn').addEventListener('click', resetTable);

    // Add event listeners for college fees inputs
    document.getElementById('registrationFee').addEventListener('change', updateCollegeFeesCalculator);
    document.getElementById('lateFee').addEventListener('change', updateCollegeFeesCalculator);
    document.getElementById('otherFees').addEventListener('input', updateOtherFeesCalculator);

    // Dark mode toggle
    document.getElementById('themeToggle').addEventListener('click', toggleDarkMode);

    // Start with one row
    createRow(0);
  </script>
</body>
</html>
